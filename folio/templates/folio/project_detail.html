{% extends 'folio/base.html' %}
{% load static %}

{% block content %}
<div id="particles-js"></div>

<section class="container my-5 project-detail">

  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb glass-breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
      <li class="breadcrumb-item active">{{ project.title }}</li>
    </ol>
  </nav>

  <!-- Title -->
  <h1 class="text-center neon-text mb-4">{{ project.title }}</h1>

  <!-- Sticky Right Sidebar -->
  <aside class="project-sidebar glass-box">
    <h5>Project Summary</h5>
    <p>{{ project.description|truncatewords:40 }}</p>

    {% if project.link %}
      <a href="{{ project.link }}" target="_blank" class="btn btn-primary w-100 mb-2">ğŸ”— Live Demo</a>
    {% endif %}
    {% if project.github_link %}
      <a href="{{ project.github_link }}" target="_blank" class="btn btn-dark w-100">ğŸ’» GitHub</a>
    {% endif %}

    <hr>

    <h6>Share Project</h6>
    <div class="d-flex gap-2">
      <a class="btn btn-sm btn-outline-info" href="https://wa.me/?text={{ request.build_absolute_uri }}">
        WhatsApp
      </a>
      <a class="btn btn-sm btn-outline-primary" href="https://t.me/share/url?url={{ request.build_absolute_uri }}">
        Telegram
      </a>
      <a class="btn btn-sm btn-outline-success" href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}">
        LinkedIn
      </a>
    </div>

    <!-- QR Code -->
    <div class="text-center mt-3">
      <img src="https://api.qrserver.com/v1/create-qr-code/?size=140x140&data={{ request.build_absolute_uri }}" class="qr-img">
      <p class="small text-muted">Scan to open on phone</p>
    </div>
  </aside>

  <!-- Carousel -->
  {% if project.images.all %}
  <div id="projectCarousel" class="carousel slide mb-4 glass-box" data-bs-ride="carousel">
    <div class="carousel-inner">
      {% for img in project.images.all %}
      <div class="carousel-item {% if forloop.first %}active{% endif %}">
        <img src="{{ img.url }}" class="d-block w-100 rounded project-img">
      </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#projectCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#projectCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
  {% endif %}

  <!-- Description Full -->
  <div class="glass-box p-4 mb-4">
    <h4>ğŸ“„ Full Description</h4>
    <p>{{ project.description }}</p>
  </div>

  <!-- Technologies -->
  {% if project.technologies %}
  <div class="glass-box p-4 mb-4">
    <h5>ğŸ›  Technologies Used</h5>
    {% for tech in project.technologies.split(',') %}
      <span class="badge tech-badge">{{ tech|trim }}</span>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Timeline -->
  <div class="glass-box p-4 mb-4">
    <h5>â³ Development Timeline</h5>
    <ul class="timeline">
      <li>ğŸ“Œ Planning â†’ Wireframes</li>
      <li>ğŸš§ Development Started</li>
      <li>ğŸ§ª Testing & Debugging</li>
      <li>ğŸš€ Deployment Completed</li>
    </ul>
  </div>

  <!-- Project Stats -->
  <div class="glass-box p-4 mb-4">
    <h5>ğŸ“Š Project Stats</h5>
    <div class="row text-center">
      <div class="col">
        <h4>â±</h4><p>Duration: <b>2â€“6 weeks</b></p>
      </div>
      <div class="col">
        <h4>ğŸ“„</h4><p>Lines of Code: <b>800+ LOC</b></p>
      </div>
      <div class="col">
        <h4>ğŸ‘¥</h4><p>Team: <b>1 Developer</b></p>
      </div>
    </div>
  </div>

  <!-- Rating -->
  <div class="glass-box p-4 mb-4">
    <h5>â­ Rate this project</h5>
    <div class="stars">
      â˜…â˜…â˜…â˜…â˜…
    </div>
  </div>

  <!-- Comments -->
  <div class="glass-box p-4 mb-4">
    <h5>ğŸ’¬ Comments / Feedback</h5>
    <textarea class="form-control mb-3" rows="3" placeholder="Write your feedback..."></textarea>
    <button class="btn btn-primary">Submit</button>
  </div>

  <!-- Related Projects -->
  {% if project.category %}
  <div class="related-projects mt-5 glass-box p-4">
    <h5>ğŸ”— Related Projects</h5>
    <div class="row">
      {% for p in project.category.project_set.exclude(pk=project.pk)|slice:":3" %}
      <div class="col-md-4 mb-3">
        <a href="{% url 'project_detail' p.pk %}" class="card h-100 related-card">
          <img src="{{ p.image.url }}" class="card-img-top">
          <div class="card-body"><h6>{{ p.title }}</h6></div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</section>

<!-- Sticky Bottom Bar -->
<div class="bottom-bar">
  {% if project.link %}
    <a href="{{ project.link }}" target="_blank" class="btn btn-primary">ğŸ”— Live Project</a>
  {% endif %}
  {% if project.github_link %}
    <a href="{{ project.github_link }}" target="_blank" class="btn btn-dark">ğŸ’» GitHub</a>
  {% endif %}
</div>

<!-- Particles -->
<script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
<script>
particlesJS("particles-js", {
  particles: { number: { value: 40 }, move: { speed: 1 }, color:{value:"#00eaff"} }
});
</script>

<style>
/* Glass + Neon styles */
.neon-text{color:#00eaff;text-shadow:0 0 10px #00eaff;}
.glass-box{background:rgba(255,255,255,0.06);backdrop-filter:blur(15px);padding:20px;border-radius:15px;border:1px solid rgba(0,255,255,0.2);}
.tech-badge{background:#00eaff;color:#000;padding:6px 12px;border-radius:20px;margin:2px;font-weight:500;}
.timeline li{margin-bottom:10px;list-style:none;}
.project-sidebar{position:fixed;top:150px;right:40px;width:260px;}
.bottom-bar{position:fixed;bottom:0;left:0;width:100%;background:#000c;border-top:1px solid #00eaff;padding:10px;text-align:center;backdrop-filter:blur(10px);}
.qr-img{background:#fff;padding:5px;border-radius:10px;}
#particles-js{position:fixed;width:100%;height:100%;top:0;left:0;z-index:-5;}
</style>
{% endblock %}
