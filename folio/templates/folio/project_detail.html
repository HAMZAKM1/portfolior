{% extends 'folio/base.html' %}
{% load static %}

{% block content %}
<div id="particles-js"></div>

<section class="container my-5 project-detail">

  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb glass-breadcrumb">
      <li class="breadcrumb-item">
        <a href="{% url 'home' %}">Home</a>
      </li>
      <li class="breadcrumb-item active">{{ project.title }}</li>
    </ol>
  </nav>

  <!-- Title -->
  <h1 class="text-center neon-text mb-4">{{ project.title }}</h1>

  <!-- Sidebar -->
  <aside class="project-sidebar glass-box">
    <h5>ğŸ“Œ Project Summary</h5>
    <p>{{ project.description|truncatewords:40 }}</p>

    {% if project.link %}
      <a href="{{ project.link }}" target="_blank" class="btn btn-primary w-100 mb-2">
        ğŸ”— Live Demo
      </a>
    {% endif %}

    {% if project.github %}
      <a href="{{ project.github }}" target="_blank" class="btn btn-dark w-100">
        ğŸ’» GitHub
      </a>
    {% endif %}

    <hr>

    <h6>ğŸ“¤ Share</h6>
    <div class="d-flex gap-2">
      <a class="btn btn-sm btn-outline-success"
         href="https://wa.me/?text={{ request.build_absolute_uri }}">
         WhatsApp
      </a>
      <a class="btn btn-sm btn-outline-info"
         href="https://t.me/share/url?url={{ request.build_absolute_uri }}">
         Telegram
      </a>
      <a class="btn btn-sm btn-outline-primary"
         href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}">
         LinkedIn
      </a>
    </div>

    <!-- QR -->
    <div class="text-center mt-3">
      <img
        src="https://api.qrserver.com/v1/create-qr-code/?size=140x140&data={{ request.build_absolute_uri }}"
        class="qr-img">
      <p class="small text-muted">Scan to open</p>
    </div>
  </aside>

  <!-- Image Carousel -->
  {% if project.images.all %}
  <div id="projectCarousel" class="carousel slide mb-4 glass-box" data-bs-ride="carousel">
    <div class="carousel-inner">
      {% for img in project.images.all %}
      <div class="carousel-item {% if forloop.first %}active{% endif %}">
        <img src="{{ img.image.url }}" class="d-block w-100 rounded project-img">
      </div>
      {% endfor %}
    </div>

    <button class="carousel-control-prev" type="button" data-bs-target="#projectCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#projectCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
  {% endif %}

  <!-- Full Description -->
  <div class="glass-box p-4 mb-4">
    <h4>ğŸ“„ Full Description</h4>
    <p>{{ project.description }}</p>
  </div>

  <!-- Technologies -->
  {% if project.tech_stack.all %}
  <div class="glass-box p-4 mb-4">
    <h5>ğŸ›  Technologies Used</h5>
    {% for tech in project.tech_stack.all %}
      <span class="badge tech-badge">{{ tech.name }}</span>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Timeline -->
  <div class="glass-box p-4 mb-4">
    <h5>â³ Development Timeline</h5>
    <ul class="timeline">
      <li>ğŸ“Œ Planning & Design</li>
      <li>ğŸš§ Development</li>
      <li>ğŸ§ª Testing</li>
      <li>ğŸš€ Deployment</li>
    </ul>
  </div>

  <!-- Stats -->
  <div class="glass-box p-4 mb-4">
    <h5>ğŸ“Š Project Stats</h5>
    <div class="row text-center">
      <div class="col">
        <h4>â±</h4>
        <p>Duration: <b>2â€“6 Weeks</b></p>
      </div>
      <div class="col">
        <h4>ğŸ“„</h4>
        <p>Code: <b>800+ LOC</b></p>
      </div>
      <div class="col">
        <h4>ğŸ‘¤</h4>
        <p>Developer: <b>Solo</b></p>
      </div>
    </div>
  </div>

  <!-- Related Projects -->
  {% if project.category %}
  <div class="glass-box p-4 mt-5">
    <h5>ğŸ”— Related Projects</h5>
    <div class="row">
      {% for p in project.category.project_set.exclude(pk=project.pk)|slice:":3" %}
      <div class="col-md-4 mb-3">
        <a href="{% url 'project_detail' p.pk %}" class="card h-100 related-card">
          {% if p.cover_image %}
            <img src="{{ p.cover_image.url }}" class="card-img-top">
          {% endif %}
          <div class="card-body">
            <h6>{{ p.title }}</h6>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</section>

<!-- Bottom Bar -->
<div class="bottom-bar">
  {% if project.link %}
    <a href="{{ project.link }}" target="_blank" class="btn btn-primary">
      ğŸ”— Live Project
    </a>
  {% endif %}
  {% if project.github %}
    <a href="{{ project.github }}" target="_blank" class="btn btn-dark">
      ğŸ’» GitHub
    </a>
  {% endif %}
</div>

<!-- Particles -->
<script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
<script>
particlesJS("particles-js", {
  particles: {
    number: { value: 40 },
    move: { speed: 1 },
    color: { value: "#00eaff" }
  }
});
</script>

<style>
.neon-text {
  color:#00eaff;
  text-shadow:0 0 10px #00eaff;
}
.glass-box {
  background:rgba(255,255,255,0.06);
  backdrop-filter:blur(15px);
  border-radius:15px;
  border:1px solid rgba(0,255,255,0.2);
}
.tech-badge {
  background:#00eaff;
  color:#000;
  padding:6px 12px;
  border-radius:20px;
  margin:3px;
}
.timeline li {
  list-style:none;
  margin-bottom:8px;
}
.project-sidebar {
  position:fixed;
  top:140px;
  right:40px;
  width:260px;
}
.bottom-bar {
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#000c;
  padding:10px;
  border-top:1px solid #00eaff;
  text-align:center;
}
.qr-img {
  background:#fff;
  padding:5px;
  border-radius:10px;
}
#particles-js {
  position:fixed;
  inset:0;
  z-index:-10;
}

/* Mobile Fix */
@media (max-width: 992px) {
  .project-sidebar {
    position:static;
    width:100%;
    margin-bottom:20px;
  }
}
</style>
{% endblock %}
